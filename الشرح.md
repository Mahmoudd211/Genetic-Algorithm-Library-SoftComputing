# مكتبة الخوارزميات الوراثية للحوسبة الناعمة: شرح مفصل للمشروع

## مقدمة

يطبق هذا المشروع مكتبة خوارزميات وراثية (GA) معيارية وقابلة للتوسع في لغة Java، مصممة لحل مشاكل التحسين. الخوارزميات الوراثية مستوحاة من التطور الطبيعي، باستخدام مبادئ مثل الاختيار، التقاطع، والطفرة لتطوير الحلول عبر الأجيال. تدعم المكتبة أنواع كروموسومات متعددة، عوامل قابلة للتكوين، وتشمل دراسة حالة حقيقية لتحسين الري الذكي.

تم بناء المكتبة بمبادئ كود نظيف، تعليقات قليلة، وركيزة على فصل الاهتمامات عبر حزم مخصصة. مصممة لأغراض تعليمية كجزء من دورة الحوسبة الناعمة.

## هيكل المشروع

يتبع المشروع هيكل Maven مع الكود الرئيسي في `src/main/java/genetic/`. هيكل الدليل كالتالي:

```
src/main/java/genetic/
├── chromosome/          # تنفيذات الكروموسومات
│   ├── Chromosome.java (الأساس المجرد)
│   ├── BinaryChromosome.java
│   ├── IntegerChromosome.java
│   └── FloatChromosome.java
├── api/                  # واجهات لوظائف محددة للمشكلة
│   ├── FitnessFunction.java
│   └── InfeasibleHandler.java
├── selection/            # عوامل الاختيار
│   ├── SelectionStrategy.java (واجهة)
│   ├── RouletteWheelSelection.java
│   └── TournamentSelection.java
├── crossover/            # عوامل التقاطع
│   ├── CrossoverOperator.java (واجهة)
│   ├── OnePointCrossover.java
│   ├── TwoPointCrossover.java
│   └── UniformCrossover.java
├── mutation/             # عوامل الطفرة
│   ├── MutationOperator.java (واجهة)
│   ├── BinaryBitFlip.java
│   ├── IntegerRandomResetting.java
│   ├── IntegerCreepMutation.java
│   ├── IntegerSwap.java
│   ├── FloatUniformMutation.java
│   └── FloatGaussian.java
├── replacement/          # استراتيجيات الاستبدال
│   ├── ReplacementStrategy.java (واجهة)
│   ├── Elitism.java
│   ├── SteadyState.java
│   └── GenerationalReplacement.java
├── Population.java       # إدارة السكان
├── GeneticAlgorithm.java # الفئة الرئيسية للـ GA
└── examples/             # تنفيذ دراسة الحالة
    └── CaseStudyApplication.java
```

## المكونات الأساسية

### الكروموسومات

تمثل الكروموسومات الحلول المحتملة في الـ GA. تدعم المكتبة ثلاثة أنواع: ثنائي، صحيح، وكسري.

#### الأساس المجرد: Chromosome.java
```java
public abstract class Chromosome {
    protected double fitness;

    public abstract void initialize();
    public abstract List<Chromosome> crossover(Chromosome other);
    public abstract void mutate();
    public double getFitness() { return fitness; }
    public void setFitness(double fitness) { this.fitness = fitness; }
    public abstract int getLength();
    public abstract Chromosome copy();
}
```

#### BinaryChromosome.java
يمثل الحلول كمصفوفات من القيم المنطقية. مفيد لمشاكل التحسين المنفصلة.
- التهيئة: تعيين كل بت عشوائياً إلى صحيح أو خطأ.
- التقاطع: منفذ في العوامل (انظر أدناه).
- الطفرة: قلب البت (انظر BinaryBitFlip).
- الطول: عدد البتات.

#### IntegerChromosome.java
يمثل الحلول كمصفوفات من الأعداد الصحيحة ضمن حدود محددة.
- التهيئة: قيم عشوائية بين الحد الأدنى والأقصى.
- التقاطع: منفذ في العوامل.
- الطفرة: طفرات صحيحة متنوعة (انظر أدناه).
- الطول: عدد الجينات.

#### FloatChromosome.java
يمثل الحلول كمصفوفات من الأعداد الكسرية ضمن حدود محددة.
- التهيئة: قيم عشوائية بين الحد الأدنى والأقصى.
- التقاطع: منفذ في العوامل.
- الطفرة: طفرات كسرية متنوعة (انظر أدناه).
- الطول: عدد الجينات.

### إدارة السكان: Population.java

يدير مجموعة من الكروموسومات.
- التهيئة: إنشاء سكان بحجم محدد باستخدام كروموسوم نموذجي.
- تقييم اللياقة: تطبيق دالة اللياقة على جميع الكروموسومات.
- الترتيب: حسب اللياقة (تصاعدي أو تنازلي).
- الأفضل/الأسوأ: العثور على الكروموسومات ذات اللياقة الأعلى/الأدنى.

### عوامل التطور

#### استراتيجيات الاختيار

يختار الاختيار الآباء للتكاثر بناءً على اللياقة.

##### SelectionStrategy.java (واجهة)
```java
public interface SelectionStrategy {
    Chromosome select(Population population);
}
```

##### RouletteWheelSelection.java
اختيار احتمالي حيث يكون للأفراد الأصلح فرصة أعلى للاختيار.
- حساب اللياقة الإجمالية.
- دوران "عجلة" مقسمة حسب نسب اللياقة.
- إرجاع الكروموسوم حيث يقع الدوران.

##### TournamentSelection.java
يختار الأفضل من مجموعة فرعية عشوائية (بطولة).
- اختيار عشوائي لحجم البطولة من الأفراد.
- إرجاع الذي له أعلى لياقة.

#### عوامل التقاطع

يجمع التقاطع المادة الوراثية من والدين لإنشاء ذرية.

##### CrossoverOperator.java (واجهة)
```java
public interface CrossoverOperator {
    List<Chromosome> crossover(Chromosome parent1, Chromosome parent2);
}
```

##### OnePointCrossover.java
يتبادل القطاعات بعد نقطة واحدة عشوائية.
- اختيار نقطة تقاطع عشوائية.
- الذرية1: جينات الوالد1 قبل النقطة + جينات الوالد2 بعد النقطة.
- الذرية2: جينات الوالد2 قبل النقطة + جينات الوالد1 بعد النقطة.
- يعمل لجميع أنواع الكروموسومات.

##### TwoPointCrossover.java
يتبادل القطاعات بين نقطتين عشوائيتين.
- اختيار نقطتين عشوائيتين (نقطة1 < نقطة2).
- تبادل الجينات بين نقطة1 ونقطة2.
- الذرية1: جينات الوالد1 خارج [نقطة1، نقطة2) + جينات الوالد2 داخل.
- الذرية2: جينات الوالد2 خارج [نقطة1، نقطة2) + جينات الوالد1 داخل.
- يعمل لجميع أنواع الكروموسومات.

##### UniformCrossover.java
كل جين يتم تبادله باحتمالية 50%.
- لكل موضع جين، يقرر عشوائياً ما إذا كان يتبادل.
- إذا تبادل: الذرية1 تحصل على جين الوالد2، الذرية2 تحصل على جين الوالد1.
- وإلا: الذرية1 تحصل على جين الوالد1، الذرية2 تحصل على جين الوالد2.
- يعمل لجميع أنواع الكروموسومات.

#### عوامل الطفرة

تدخل الطفرة تغييرات عشوائية للحفاظ على التنوع.

##### MutationOperator.java (واجهة)
```java
public interface MutationOperator {
    void mutate(Chromosome chromosome, int currentGeneration, int maxGenerations);
}
```

##### BinaryBitFlip.java
يقلب البتات في الكروموسومات الثنائية.
- لكل بت، باحتمالية mutationRate، يقلب (صحيح->خطأ، خطأ->صحيح).

##### IntegerRandomResetting.java
يعيد تعيين جينات الصحيح إلى قيم عشوائية.
- لكل جين، باحتمالية mutationRate، يعين إلى قيمة عشوائية في [min، max].

##### IntegerCreepMutation.java
يضيف تغييرات صغيرة عشوائية إلى جينات الصحيح.
- لكل جين، باحتمالية mutationRate، يضيف دلتا عشوائي في [-creepRange، +creepRange].
- يقيد بالحدود.

##### IntegerSwap.java
يتبادل جينين عشوائيين في الكروموسومات الصحيحة.
- لكل جين، باحتمالية mutationRate، يتبادل مع جين عشوائي آخر.

##### FloatUniformMutation.java
يعين جينات الكسر إلى قيم عشوائية منتظمة.
- لكل جين، باحتمالية mutationRate، يعين إلى قيمة عشوائية في [min، max].

##### FloatGaussian.java
يضيف ضوضاء غاوسية إلى جينات الكسر.
- لكل جين، باحتمالية mutationRate، يضيف ضوضاء غاوسية مع stdDev.
- متغير زمنياً: الضوضاء تقل عبر الأجيال.
- يقيد بالحدود.

#### استراتيجيات الاستبدال

تحدد كيفية تشكيل الجيل التالي من السكان الحاليين والذرية.

##### ReplacementStrategy.java (واجهة)
```java
public interface ReplacementStrategy {
    Population replace(Population currentPopulation, List<Chromosome> offspring);
}
```

##### Elitism.java
يحتفظ بالأفراد الأفضل من السكان الحاليين.
- يرتب السكان الحاليين تنازلياً حسب اللياقة.
- يأخذ أعلى eliteSize نخبة.
- يأخذ أعلى (populationSize - eliteSize) من الذرية (مرتبة تنازلياً).
- السكان الجدد: النخبة + أفضل الذرية.

##### SteadyState.java
يستبدل الأفراد الأسوأ بالذرية.
- يستبدل أسوأ numToReplace أفراد بالأول numToReplace من الذرية.

##### GenerationalReplacement.java
يستبدل السكان بأكملهم بالذرية.
- السكان الجدد هي قائمة الذرية.

### الفئة الرئيسية للـ GA: GeneticAlgorithm.java

تنسق عملية التطور.
- التكوين: حجم السكان، الأجيال، الاحتماليات، العوامل.
- طريقة التشغيل: تهيئة السكان، تقييم اللياقة، حلقة عبر الأجيال (اختيار، تقاطع، طفرة، استبدال)، إرجاع أفضل حل.

### الواجهات المحددة للمشكلة

#### FitnessFunction.java
```java
public interface FitnessFunction {
    double evaluate(Chromosome chromosome);
}
```
تحدد كيفية حساب اللياقة (الأعلى أفضل).

#### InfeasibleHandler.java
```java
public interface InfeasibleHandler {
    Chromosome handle(Chromosome chromosome);
}
```
يصلح أو يعاقب الحلول غير القابلة للتحقيق.

## دراسة الحالة: تحسين الري الذكي

يتم توضيح المكتبة بتحسين الري لـ 5 قطع زراعية.

### وصف المشكلة
- **الهدف**: تقليل إجمالي استخدام الماء مع الحفاظ على رطوبة التربة فوق 0.5 لكل قطعة.
- **المتغيرات**: كميات الري (0-10 لتر) لكل قطعة.
- **القيود**: الرطوبة = الري * معدل_الامتصاص >= 0.5.
- **معدلات الامتصاص**: [0.8، 0.9، 1.0، 0.7، 0.85]

### تكوين الـ GA
- **الكروموسوم**: FloatChromosome (5 جينات، 0-10).
- **اللياقة**: 1 / (الماء_الإجمالي + العقوبة)، حيث العقوبة = 100 * مجموع(max(0، 0.5 - الرطوبة)).
- **معالجة غير القابل للتحقيق**: زيادة الري للقطع المجففة.
- **العوامل**: قابلة للاختيار عبر إدخال المستخدم.

### تدفق التطبيق (CaseStudyApplication.java)
1. مطالبة المستخدم بنوع الكروموسوم، الاختيار، التقاطع، الطفرة، الاستبدال.
2. إعداد GA بالافتراضيات (50 سكان، 100 جيل، 0.7 احتمال تقاطع، 0.05 احتمال طفرة).
3. تشغيل GA، قياس الوقت.
4. إخراج خطة الري المثلى، الماء الإجمالي، أفضل لياقة، وقت التشغيل.

## دليل الاستخدام

### المتطلبات الأساسية
- Java 11+
- Maven 3.6+

### البناء
```bash
mvn clean compile
```

### تشغيل دراسة الحالة
```bash
mvn exec:java -Dexec.mainClass="genetic.examples.CaseStudyApplication"
```

### استخدام المكتبة

1. **تكوين GA**:
```java
GeneticAlgorithm ga = new GeneticAlgorithm();
ga.setPopulationSize(50);
ga.setGenerations(100);
ga.setCrossoverProbability(0.7);
ga.setMutationProbability(0.05);
ga.setSelectionStrategy(new TournamentSelection(3));
ga.setCrossoverOperator(new TwoPointCrossover());
ga.setMutationOperator(new FloatGaussian(0.05, 0.1));
ga.setReplacementStrategy(new Elitism(5));
```

2. **تحديد وظائف المشكلة**:
```java
FitnessFunction fitness = chromosome -> {
    // حساب اللياقة
    return fitnessValue;
};

InfeasibleHandler handler = chromosome -> {
    // إصلاح الكروموسوم
    return repaired;
};

ga.setFitnessFunction(fitness);
ga.setInfeasibleHandler(handler);
ga.setPrototype(new FloatChromosome(length, min, max));
```

3. **التشغيل**:
```java
Chromosome best = ga.run();
```

## التكوين الافتراضي

- حجم السكان: 50
- الأجيال: 100
- احتمالية التقاطع: 0.7
- احتمالية الطفرة: 0.05
- الاختيار: بطولة (حجم 3)
- التقاطع: نقطتان
- الاستبدال: نخبة (نخبة 5)

## القابلية للتوسع

- إضافة أنواع كروموسومات بتوسيع Chromosome.
- تنفيذ عوامل جديدة بتوسيع الواجهات.
- تخصيص عبر FitnessFunction و InfeasibleHandler.

## التبعيات

- مكتبة Java القياسية (لا تبعيات خارجية).

## الترخيص

أغراض تعليمية، دورة الحوسبة الناعمة.
